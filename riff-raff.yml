regions: [eu-west-1]
stacks: [deploy]
deployments:
  repo-fetcher:
    type: aws-lambda
    sources:
      - packages/repo-fetcher/dist/repo-fetcher.zip
    dependencies: [cdk-cloudformation]
    actions:
      - uploadLambda
      - updateLambda
    parameters:
      bucketSsmLookup: true
      fileName: repo-fetcher.zip
      lookupByTags: true
  cdk-cloudformation:
    type: cloud-formation
    sources:
      - packages/cdk/cdk.out/GithubLens-CODE.template.json
    app: github-lens
    parameters:
      prependStackToCloudFormationStackName: false
      cloudFormationStackName: github-lens
      templateStagePaths:
        CODE: GithubLens-CODE.template.json
      cloudFormationStackByTags: false